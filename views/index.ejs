<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:100,300,400,600" rel="stylesheet" type="text/css">
    <link href="http://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css" rel="stylesheet" type="text/css">
    <link type="text/css" rel="stylesheet" href="stylesheets/style.css">
    <!-- <script src="javascripts/app.js"></script> -->
    <script src="https://code.jquery.com/jquery-3.5.0.js"></script>
    <title>Budgety</title>
    <script>


        // $('#add_btn').click(function(){
        //     alert("success");

        // })

        // $('#add_btn').on('click', function(){
        //     // var type = document.querySelector('.add__type').value;
        //     // var description = document.querySelector('.add__description').value;
        //     // var value = document.querySelector('.add__value').value;
        //     // console.log(type, description, value);
        //     console.log('hi');
        // });

        // $(document).ready(function(){
        //     $.ajax({
        //         type: "GET",
        //         url: "/api/add",
        //         success: function(){

        //         }
        //     })
        // })

        // $(function(){
        //     getDataList();

        // });

        // function getDataList(){
        //     $.ajax({
        //     type: "GET",
        //     url:"/api/add",

        //     error: function(){
        //         alert("Get fail");
        //     },
        //     success: function(user_List){
        //         alert(typeof(user_List));

        // var incomeList = $('.income__list');
        // var expenseList = $('.expenses__list');
        // if (type == 'inc'){
        //     incomeList.append
        //         }


        //     });
        // }

        



        function addItemPost() {
            var type = document.querySelector('.add__type').value;
            var description = document.querySelector('.add__description').value;
            var value = document.querySelector('.add__value').value;
            // console.log(type, description, value);
            var incomeList = $('#income_list_parent');
            var expenseList = $('#expense_list_parent');

            $.ajax({
                type: "POST",
                url: "/api/add",
                data: {
                    add_type: type,
                    add_description: description,
                    add_value: value
                },
                success: function (data) {

                    alert("add Success");
                    console.log(data);
                    if (type == 'inc') {
                        incomeList.append('<div class="income__list" id="row-'+data._id+'"><div class="item clearfix" id="' + data.type + '"><div class="item__description">' + data.description + '</div><div class="right clearfix"><div class="item__value">' + data.value + '</div><div class="item__delete"><button class="item__delete--btn" onclick="deleteItem(\''+data._id+'\' );"><i class="ion-ios-close-outline"></i></button></div></div></div></div>')

                    } else {
                        expenseList.append('<div class="expenses__list" id="row-'+data._id+'"><div class="item clearfix" id="' + data.type + '"><div class="item__description">' + data.description + '</div><div class="right clearfix"><div class="item__value">' + data.value + '<div class="item__percentage">21%</div><div class="item__delete"><button class="item__delete--btn"onclick="deleteItem(\''+data._id+'\' );"><i class="ion-ios-close-outline"></i></button></div></div></div></div>')
                    }

                }

            })

        }
            // $('.item__delete--btn').on('click', function(itemId){
            //     $.ajax({
            //         type: "POST",
            //         url: "/api/delete",
            //         data: {id: itemId},
            //         success: function() {
            //             alert("delete Success");
            //             $("#row-"+itemId).remove();
            //             //delete from from the table
            //         }
            //     });
            // })

            // Delete button-Success!
            function deleteItem(itemId) {
                $.ajax({
                    type: "POST",
                    url: "/api/delete",
                    data: {id: itemId},
                    success: function() {
                        alert("delete Success");
                        $("#row-"+itemId).remove();
                        //delete from from the table
                    }
                });
            }

            // function addItem(typeItem, descriptionItem, valueItem){
            //     $.ajax({
            //         type: "POST",
            //         url: "/api/add",
            //         data: {
            //             type: typeItem,
            //             description: descriptionItem,
            //             value: valueItem
            //         },
            //         success: function() {
            //             alert("add Success")
            //             $("#row-"+itemId).
            //         }
            //         //add item and 
            //     })
            // }
    </script>
</head>

<body>

    <div class="top">
        <div class="budget">
            <div class="budget__title">
                Availables Budget in2 </span>: 
                <!-- 
                
                // var addList = function(data){
                //     console.log(data);
                //     var incomeList = document.querySelector('.income__list');
                //     var expenseList = document.querySelector('.expenses__list');
                    
                //     for(i=0; i<data.lenth; i++){
                //         if ('inc' == data[i].type) {
                //                 incomeList.append('<div class="item clearfix" id="' + data[i].id  + '"><div class="item__description">' + data[i].description + '</div><div class="right clearfix"><div class="item__value">' + data[i].value + '</div><div class="item__delete"><button class="item__delete--btn"><i class="ion-ios-close-outline"></i></button></div></div></div>')

                //         } else {
                //                 expenseList.append('<div class="item clearfix" id="' + data[i].id  + '"><div class="item__description">' + data[i].description + '</div><div class="right clearfix"><div class="item__value">' + data[i].value + '</div><div class="item__delete"><button class="item__delete--btn"><i class="ion-ios-close-outline"></i></button></div></div></div>')
                //             }

                //     }
                    
                // }
                // var itemData = user_List;
                // addList(itemData);

                 -->
                

            </div>

            <div class="budget__value">+ 2,345.64</div>

            <div class="budget__income clearfix">
                <div class="budget__income--text">Income</div>
                <div class="right">
                    <div class="budget__income--value">+ 4,300.00</div>
                    <div class="budget__income--percentage">&nbsp;</div>
                </div>
            </div>

            <div class="budget__expenses clearfix">
                <div class="budget__expenses--text">Expenses</div>
                <div class="right clearfix">
                    <div class="budget__expenses--value">- 1,954.36</div>
                    <div class="budget__expenses--percentage">45%</div>
                </div>
            </div>
        </div>
    </div>



    <div class="bottom">
        <div class="add">


            <div class="add__container">
                <select name="add_type" class="add__type">
                    <option value="inc" selected>+</option>
                    <option value="exp">-</option>
                </select>
                <input type="text" name="add_description" class="add__description" placeholder="Add description">
                <input type="number" name="add_value" class="add__value" placeholder="Value">
                <button type="submit" class="add__btn" id="add_btn" onclick="addItemPost()"><i
                        class="ion-ios-checkmark-outline"></i></button>

            </div>

        </div>

        <div class="container clearfix">


            <div class="income">
                <h2 class="icome__title">Income</h2>

                <div id="income_list_parent">
                    <% for(var i = 0; i < user_List.length; i++){ %> 
                        <% if('inc' == user_List[i].type){%>
                            <div class="income__list" id="row-<%= user_List[i].id %>">

                                <div class="item clearfix" id="income-<%= i %>">
                                    <div class="item__description"><%= user_List[i].description%></div>
                                    <div class="right clearfix">
                                        <div class="item__value">+ <%= user_List[i].value%></div>
                                        <div class="item__delete">
                                            <button class="item__delete--btn" onclick="deleteItem('<%= user_List[i].id %>');"><i class="ion-ios-close-outline"></i></button>
                                    
                                        </div>
                                    </div>
                                </div>
                            </div>
                        <%}%>
                    <% } %>

                </div>
  
            </div>



            <div class="expenses">
                <h2 class="expenses__title">Expenses</h2>

                <div class="expense_list_parent">
                    <% for(var i = 0; i < user_List.length; i++){ %> 
                        <% if('exp'==user_List[i].type){%>
                            <div class="expenses__list" id="row-<%= user_List[i].id %>">
                                <div class="item clearfix" id="expense-<%= i %>">
                                    <div class="item__description"><%= user_List[i].description%></div>
                                    <div class="right clearfix">
                                        <div class="item__value">- <%= user_List[i].value%></div>
                                        <div class="item__percentage">21%</div>
                                        <div class="item__delete">
                                            <button class="item__delete--btn"  onclick="deleteItem('<%= user_List[i].id %>');"><i class="ion-ios-close-outline"></i></button>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        <%}%>
                    <% } %>
                </div>
               
            </div>


        </div>

    </div>


</body>

</html>